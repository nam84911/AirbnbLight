{"version":3,"sources":["src/app/booking/booking.page.html","src/app/booking/booking-routing.module.ts","src/app/booking/booking.model.ts","src/app/booking/booking.module.ts","src/app/booking/booking.page.scss","src/app/booking/booking.page.ts","src/app/booking/booking.service.ts"],"names":[],"mappings":"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","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-button fill=\\\"clear\\\"color=\\\"primary\\\"  slot=\\\"start\\\">\\n      <ion-menu-button menu=\\\"first\\\"></ion-menu-button>\\n    </ion-button>\\n    <ion-title>Bookings</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n  <div class=\\\"ion-text-center\\\" *ngIf=\\\"isLoading\\\">\\n    <ion-spinner></ion-spinner>\\n  </div>\\n  <ion-grid *ngIf=\\\"!isLoading\\\"> \\n    <ion-row>\\n      <ion-col size-md=\\\"6\\\" offset-md=\\\"3\\\">\\n        <ion-list>\\n          <ion-item-sliding *ngFor =\\\"let booking of bookings\\\" #slider>\\n            <ion-item>\\n                <ion-thumbnail slot=\\\"start\\\">\\n                  <ion-img [src]=\\\"booking.photoURL\\\"></ion-img>\\n                </ion-thumbnail>\\n                <ion-title>\\n                  <ion-label>\\n                        <ion-grid >\\n                          <ion-row>\\n                            <ion-col class=\\\"ion-text-start\\\"size-sm=\\\"7\\\">\\n                              <h5>{{booking.title}}</h5>\\n                            </ion-col>\\n                            <ion-col class=\\\"ion-text-end\\\" size-sm=\\\"5\\\">\\n                              <p>Guests: {{booking.guests}}</p>\\n                            </ion-col>\\n                          </ion-row>\\n\\n                          <ion-row>\\n                            <ion-col class=\\\"ion-text-start\\\"size=\\\"6\\\">\\n                              <ion-icon name=\\\"calendar\\\"></ion-icon>\\n                              {{booking.from.getFullYear()}}/{{booking.from.getMonth()}}/{{booking.from.getDate()}}\\n                            </ion-col>\\n                            <ion-col class=\\\"ion-text-end\\\" size=\\\"6\\\">\\n                              <ion-icon name=\\\"calendar\\\"></ion-icon>\\n                              {{booking.to.getFullYear()}}/{{booking.to.getMonth()}}/{{booking.to.getDate()}}\\n                            </ion-col>\\n                          </ion-row>\\n                        </ion-grid>\\n                      \\n                  </ion-label>\\n                </ion-title>\\n            </ion-item>\\n            <ion-item-options>\\n              <ion-item-option color=\\\"danger\\\" (click)=\\\"onDelete(booking.id,slider)\\\">\\n                <ion-icon name=\\\"trash\\\" slot=\\\"icon-only\\\"></ion-icon>\\n              </ion-item-option>\\n            </ion-item-options>\\n\\n            <ion-item-options side=\\\"start\\\" >\\n              <ion-item-option color=\\\"danger\\\" (click)=\\\"onDelete(booking.id,slider)\\\">\\n                <ion-icon name=\\\"trash\\\" slot=\\\"icon-only\\\"></ion-icon>\\n              </ion-item-option>\\n            </ion-item-options>\\n          </ion-item-sliding>\\n        </ion-list>\\n      </ion-col>\\n    </ion-row>\\n  </ion-grid>\\n\\n</ion-content>\\n\"","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { BookingPage } from './booking.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: BookingPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class BookingPageRoutingModule {}\n","export class Booking{\n    constructor(\n        public id:String,\n        public placeId:String,\n        public userId:String,\n        public title:String,\n        public guests:number,\n        public first:string,\n        public last:string,\n        public photoURL:string,\n        public from:Date,\n        public to:Date){}\n}","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { BookingPageRoutingModule } from './booking-routing.module';\n\nimport { BookingPage } from './booking.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    BookingPageRoutingModule\n  ],\n  declarations: [BookingPage]\n})\nexport class BookingPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2Jvb2tpbmcvYm9va2luZy5wYWdlLnNjc3MifQ== */\"","import { Component, OnInit } from '@angular/core';\nimport { Booking } from './booking.model';\nimport { BookingService } from './booking.service';\nimport { IonItemSliding, LoadingController } from '@ionic/angular';\n\n@Component({\n  selector: 'app-booking',\n  templateUrl: './booking.page.html',\n  styleUrls: ['./booking.page.scss'],\n})\nexport class BookingPage implements OnInit {\n  bookings:Booking[]\n  isLoading=true\n  constructor(private loading:LoadingController,private service :BookingService) { }\n\n  ngOnInit() {\n    this.service.bookings.subscribe(bookings=>{\n      this.bookings=bookings\n    })\n  }\n  ionViewWillEnter(){\n    this.isLoading=true\n    this.service.fetchBooking().subscribe(()=>{\n      this.isLoading=false\n    })\n  }\n  onDelete(id:string, slider:IonItemSliding){\n    slider.close()\n    this.loading.create({message:\"Loading\"}).then(ctr=>{\n      ctr.present()\n      this.service.cancelBooking(id).subscribe(()=>{\n        ctr.dismiss()\n      })\n    })\n  }\n\n}\n","import { Injectable } from '@angular/core';\nimport { Booking } from './booking.model';\nimport { BehaviorSubject } from 'rxjs';\nimport {take,map,tap,delay, switchMap} from \"rxjs/operators\"\nimport { HttpClient } from '@angular/common/http';\nimport { AuthService } from '../auth/auth.service';\ninterface BookingData{\n   placeId:String,\n   userId:String,\n   title:String,\n   guests:number,\n   first:string,\n   last:string,\n   photoURL:string,\n   from:Date,\n   to:Date\n}\n@Injectable({\n  providedIn: 'root'\n})\nexport class BookingService {\n private _bookings= new BehaviorSubject<Booking[]>([])\n\n get bookings(){\n  return this._bookings.asObservable()\n}\n  constructor(private http:HttpClient,private auth:AuthService) { }\n fetchBooking(){\n  return this.http.get<{[key:string]:BookingData}>(`https://airbnblight.firebaseio.com/bookings.json?orderBy=\"userId\"&equalTo=\"${this.auth.userId}\"`).\n  pipe(map(res=>{\n    const bookings:Booking[]=[]\n    for(let s in res){\n      if(res.hasOwnProperty(s)){\n        bookings.push(new Booking(\n          s,\n          res[s].placeId,\n          res[s].userId,\n          res[s].title,\n          +res[s].guests,\n          res[s].first,\n          res[s].last,\n          res[s].photoURL,\n          new Date(res[s].from),\n          new Date(res[s].to)\n        ))\n      }\n    }\n    return bookings\n  }),tap(bookings=>{\n    this._bookings.next(bookings)\n  }))\n\n }\n  cancelBooking(id){\n    return this.http.delete(`https://airbnblight.firebaseio.com/bookings/${id}.json`).pipe(\n      switchMap(res=>{\n        console.log(res)\n        return this._bookings\n      }),take(1),tap(bookings=>{\n        this._bookings.next(bookings.filter(b=>b.id!=id))\n      })\n    )\n    \n    /*return this.bookings.pipe(take(1),delay(1000),tap(bookings=>{\n      this._bookings.next(bookings.filter(b=>b.id!=id))\n    }))*/\n  }\n addBooking(id,\n            placeId,\n            userId,\n            title,\n            guests,\n            first,\n            last,\n            photoURL,\n            from,\n            to){\n    const booking=new Booking(id,\n                            placeId,\n                            userId,\n                            title,\n                            guests,\n                            first,\n                            last,\n                            photoURL,\n                            from,\n                            to)\n      let idIs:string\n      return this.http.post<{name:string}>(`https://airbnblight.firebaseio.com/bookings.json`,{...booking,id:null}).\n      pipe(switchMap(res=>{\n        idIs=res.name\n        return this._bookings\n      }),take(1),tap(places=>{\n        booking.id=idIs\n        this._bookings.next(places.concat(booking))\n      }))\n    /*return this._bookings.pipe(take(1),delay(1000),tap(bookings=>{\n      this._bookings.next(bookings.concat(booking))\n    }))*/\n\n  }\n}\n"],"sourceRoot":"webpack:///","file":"booking-booking-module-es5.js"}